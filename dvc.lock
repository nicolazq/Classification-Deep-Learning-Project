schema: '2.0'
stages:
  data_load:
    cmd: python src/stages/data_load.py --config=params.yaml
    deps:
    - path: src/stages/data_load.py
      hash: md5
      md5: a9c1a2f4732d099cb7c8123342a55bfe
      size: 1261
    params:
      params.yaml:
        base:
          random_state: 42
          log_level: INFO
          mlflow_experiment_name: classification
        data_load:
          dataset_url: https://download.pytorch.org/tutorial/hymenoptera_data.zip
          dataset_filename: hymenoptera_data.zip
          dataset_folder: data/hymenoptera_data
    outs:
    - path: data/
      hash: md5
      md5: c374b03a7f85ac0dac6d30a555fe9892.dir
      size: 47385924
      nfiles: 398
  train:
    cmd: python src/stages/train.py --config=params.yaml
    deps:
    - path: data/
      hash: md5
      md5: c374b03a7f85ac0dac6d30a555fe9892.dir
      size: 47385924
      nfiles: 398
    - path: src/stages/train.py
      hash: md5
      md5: a364dea5e2eb5d3f5c0f78dce61fd934
      size: 2866
    params:
      params.yaml:
        base:
          random_state: 42
          log_level: INFO
          mlflow_experiment_name: classification
        train:
          base_model_name: resnet18
          base_model_trainable: false
          num_epochs: 1
          optim_name: SGD
          optim:
            SGD:
              lr: 0.001
              momentum: 0.9
          lrs_name: StepLR
          lrs:
            StepLR:
              step_size: 7
              gamma: 0.1
          model_path: models/model.pt
    outs:
    - path: models/
      hash: md5
      md5: 6aeedd0681de71797d31cf78bd46e1a6.dir
      size: 44780546
      nfiles: 1
  evaluate:
    cmd: python src/stages/evaluate.py --config=params.yaml
    deps:
    - path: data/
      hash: md5
      md5: c374b03a7f85ac0dac6d30a555fe9892.dir
      size: 47385924
      nfiles: 398
    - path: models/
      hash: md5
      md5: 6aeedd0681de71797d31cf78bd46e1a6.dir
      size: 44780546
      nfiles: 1
    - path: src/stages/evaluate.py
      hash: md5
      md5: e4bf0f98e2e4e9048a10406569662837
      size: 5258
    params:
      params.yaml:
        base:
          random_state: 42
          log_level: INFO
          mlflow_experiment_name: classification
        evaluate:
          reports_dir: reports
          metrics_file: metrics.json
          confusion_matrix_image: confusion_matrix.png
    outs:
    - path: reports/
      hash: md5
      md5: 6016dda8f6cbb098a7aaf1d1ca7b9d4e.dir
      size: 20128
      nfiles: 2
